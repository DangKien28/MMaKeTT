<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>H·ªì S∆° C·ªßa T√¥i</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
        .profile-container { max-width: 600px; margin: 30px auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        
        /* Avatar Upload Area (MMK-165, 166) */
        .avatar-upload { display: flex; flex-direction: column; align-items: center; margin-bottom: 30px; }
        .avatar-preview { 
            width: 150px; height: 150px; border-radius: 50%; object-fit: cover; 
            border: 4px solid #f1f1f1; box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 15px; cursor: pointer; transition: 0.3s;
        }
        .avatar-preview:hover { opacity: 0.8; border-color: #3498db; }
        
        .upload-btn-wrapper { position: relative; overflow: hidden; display: inline-block; }
        .btn-upload { border: 1px solid #ddd; color: #555; background-color: white; padding: 8px 20px; border-radius: 4px; font-weight: bold; cursor: pointer; }
        .upload-btn-wrapper input[type=file] { font-size: 100px; position: absolute; left: 0; top: 0; opacity: 0; cursor: pointer; }
        
        .form-row { margin-bottom: 15px; }
        .form-row label { display: block; margin-bottom: 5px; font-weight: bold; color: #555; }
        .form-row input { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; }
        .readonly { background-color: #f9f9f9; color: #777; cursor: not-allowed; }
    </style>
</head>
<body>
    <header class="header">
        <div class="nav-container">
            <h1>üë§ H·ªì S∆° C√° Nh√¢n</h1>
            <nav>
                <a href="/" class="nav-link">Mua S·∫Øm</a>
                <a href="/cart" class="nav-link">Gi·ªè H√†ng</a>
            </nav>
        </div>
    </header>

    <main class="container">
        <div class="profile-container">
            <!-- MMK-165: Xem tr∆∞·ªõc ·∫£nh -->
            <div class="avatar-upload">
                <img id="avatar-img" src="{{ user.avatar }}" alt="Avatar" class="avatar-preview" onclick="document.getElementById('file-input').click()">
                
                <!-- MMK-167: Ch·ªçn ·∫£nh t·ª´ th∆∞ vi·ªán -->
                <div class="upload-btn-wrapper">
                    <button class="btn-upload">üì∑ ƒê·ªïi ·∫¢nh ƒê·∫°i Di·ªán (MMK-166)</button>
                    <!-- MMK-168: accept ch·ªâ cho ph√©p ·∫£nh -->
                    <input type="file" id="file-input" accept="image/png, image/jpeg, image/jpg">
                </div>
                <p style="font-size: 12px; color: #999; margin-top: 5px;">D·ª•ng l∆∞·ª£ng t·ªëi ƒëa: 2MB. ƒê·ªãnh d·∫°ng: JPG, PNG</p>
            </div>

            <!-- Form th√¥ng tin (MMK-173) -->
            <div class="form-row">
                <label>Email (Kh√¥ng th·ªÉ thay ƒë·ªïi)</label>
                <input type="text" value="{{ user.email }}" class="readonly" readonly>
            </div>
            <div class="form-row">
                <label>H·ªç v√† t√™n</label>
                <input type="text" id="profile-name" value="{{ user.name }}">
            </div>
            <div class="form-row">
                <label>S·ªë ƒëi·ªán tho·∫°i</label>
                <input type="text" id="profile-phone" value="{{ user.phone }}">
            </div>
            <div class="form-row">
                <label>ƒê·ªãa ch·ªâ</label>
                <input type="text" id="profile-address" value="{{ user.address }}">
            </div>

            <button onclick="saveProfile()" class="action-btn primary full-width" style="margin-top: 10px;">üíæ L∆ØU THAY ƒê·ªîI</button>
        </div>
    </main>
    
    <div id="toast" class="toast hidden">C·∫≠p nh·∫≠t th√†nh c√¥ng!</div>

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    <script>document.addEventListener('DOMContentLoaded', initProfilePage);</script>
</body>
</html>